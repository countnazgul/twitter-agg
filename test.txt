{
"title":"How can i perform incremental load in qlikview",
"description":"<p>i have a transaction table and it has addition of new records daily. I want to build a QVD file which only load incremental data.</p>",
"summary":"<p>i have a transaction table and it has addition of new records daily. I want to build a QVD file which only load incremental data.</p>",
"date":"2014-09-25T09:45:57.000Z",
"pubdate":"2014-09-25T05:37:14.000Z",
"pubDate":"2014-09-25T05:37:14.000Z",
"link":"http://stackoverflow.com/questions/26031330/how-can-i-perform-incremental-load-in-qlikview",
"guid":"http://stackoverflow.com/q/26031330",
"author":"Deepak Kumar",


"comments":null,
"origlink":null,
"image":{},
"source":{},
"categories":["load","qlikview"],
"enclosures":[],
"atom:@":{},
"atom:id":{"@":{},"#":"http://stackoverflow.com/q/26031330"},
"re:rank":{"@":{"scheme":"http://stackoverflow.com"},"#":"0"},
"atom:title":{"@":{"type":"text"},"#":"How can i perform incremental load in qlikview"},
"atom:category":[{"@":{"scheme":"http://stackoverflow.com/tags","term":"load"}},{"@":{"scheme":"http://stackoverflow.com/tags","term":"qlikview"}}],
"atom:author":{"@":{},"name":{"@":{},"#":"Deepak Kumar"},
"uri":{"@":{},"#":"http://stackoverflow.com/users/4077775"}},
"atom:link":{"@":{"rel":"alternate",
"href":"http://stackoverflow.com/questions/26031330/how-can-i-perform-incremental-load-in-qlikview"}},
"atom:published":{"@":{},"#":"2014-09-25T05:37:14Z"},
"atom:updated":{"@":{},"#":"2014-09-25T09:45:57Z"},
"atom:summary":{"@":{"type":"html"},"#":"<p>i have a transaction table and it has addition of new records daily. I want to build a QVD file which only load incremental data.</p>"},
"meta":{"#ns":[{"xmlns":"http://www.w3.org/2005/Atom"},
{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},
{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"@":[{"xmlns":"http://www.w3.org/2005/Atom"},
{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},
{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"#xml":{"version":"1.0","encoding":"utf-8"},"#type":"atom","#version":"1.0",
"title":"Newest questions tagged qlikview - Stack Overflow","description":"most recent 30 from stackoverflow.com",
"date":"2015-01-05T00:08:53.000Z","pubdate":"2015-01-05T00:08:53.000Z","pubDate":"2015-01-05T00:08:53.000Z",
"link":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest",
"xmlurl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest",
"xmlUrl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest",
"author":null,"language":null,"favicon":null,"copyright":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf",
"generator":null,"cloud":{},"image":{},"categories":[],"atom:@":{"xmlns":"http://www.w3.org/2005/Atom",
"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule","xmlns:re":"http://purl.org/atompub/rank/1.0"},
"atom:title":{"@":{"type":"text"},"#":"Newest questions tagged qlikview - Stack Overflow"},"atom:link":[{"@":{"rel":"self","href":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","type":"application/atom+xml"}},{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","type":"text/html"}}],"atom:subtitle":{"@":{},"#":"most recent 30 from stackoverflow.com"},"atom:updated":{"@":{},"#":"2015-01-05T00:08:53Z"},"atom:id":{"@":{},"#":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest"},"creativecommons:license":{"@":{},"#":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf"}}}elf","href":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","type":"application/atom+xml"}},{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","type":"text/html"}}],"atom:subtitle":{"@":{},"#":"most recent 30 from stackoverflow.com"},"atom:updated":{"@":{},"#":"2015-01-05T00:08:53Z"},"atom:id":{"@":{},"#":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest"},"creativecommons:license":{"@":{},"#":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf"}}}{"#ns":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"@":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"#xml":{"version":"1.0","encoding":"utf-8"},"#type":"atom","#version":"1.0","title":"Newest questions tagged qlikview - Stack Overflow","description":"most recent 30 from stackoverflow.com","date":"2015-01-05T00:08:53.000Z","pubdate":"2015-01-05T00:08:53.000Z","pubDate":"2015-01-05T00:08:53.000Z","link":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","xmlurl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","xmlUrl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","author":null,"language":null,"favicon":null,"copyright":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf","generator":null,"cloud":{},"image":{},"categories":[],"atom:@":{"xmlns":"http://www.w3.org/2005/Atom","xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule","xmlns:re":"http://purl.org/atompub/rank/1.0"},"atom:title":{"@":{"type":"text"},"#":"Newest questions tagged qlikview - Stack Overflow"},"atom:link":[{"@":{"rel":"self","href":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","type":"application/atom+xml"}},{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","type":"text/html"}}],"atom:subtitle":{"@":{},"#":"most recent 30 from stackoverflow.com"},"atom:updated":{"@":{},"#":"2015-01-05T00:08:53Z"},"atom:id":{"@":{},"#":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest"},"creativecommons:license":{"@":{},"#":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf"}}}ling-more-than-2-fact-tables-in-qlikview"}},"atom:published":{"@":{},"#":"2014-10-18T13:18:13Z"},"atom:updated":{"@":{},"#":"2014-10-18T13:18:13Z"},"atom:summary":{"@":{"type":"html"},"#":"<p>I am new to Qlikview and I am trying to get a solution to Link more than 3 Fact Table, I've used the approach on \"Handling Multiple fact tables in Qlikview\", and works perfectly, however when I am trying to link a 3rd table I get an error of table not found. I have 3 fact tables:</p>\n\n<p>1) Historical Data\n2) Sales\n3) Credit Memos</p>\n\n<p>All of them share must of the fields:</p>\n\n<pre><code>\"Document No_\",\n    \"Sell-to Customer No_\",\n    Type,\n    \"No_\",\n     Quantity,\n    Amount,\n    \"Bill-to Customer No_\",\n    \"Posting Date\"\n</code></pre>\n\n<p>I've follow steps 1 &amp; 2 \n1) Create a Temp Fact Table: (Load all Fields)\n2) Concatenate your keys and remove individual keys:</p>\n\n<p>My doubt is where I add the new concatenation?</p>\n\n<p>This is the example:</p>\n\n<p>Create your Link Table by concatenating your individual keys into a single table:\nThis works for Fact tables 1 and 2:</p>\n\n<pre><code>[Temp_Link_Table]:\n\nLOAD DISTINCT\n'DocNum,\n'Cusnum,\n'SKU,\n'Bill2Num,\n   Quantity,\n    Amount,\n   \"Posting Date\"\n RESIDENT [Temp_Sales_Line] ;\n\n CONCATENATE ([Temp_Link_Table])\n\n LOAD DISTINCT\n\nDocNum,\nCusnum,\nSKU,\n Quantity,\n    Amount,\n   \"Posting Date\"   \n\nRESIDENT [Temp_Hist_Sales];\n</code></pre>\n\n<p>How should I concatenate the 3?</p>\n\n<pre><code>CONCATENATE ([Temp_Link_Table])\n\n LOAD DISTINCT\n\nDocNum,\nCusnum,\nSKU,\n Quantity,\n    Amount,\n   \"Posting Date\"   \n\nRESIDENT [Temp_Credit_Memo]?????????????????????????????????\n</code></pre>\n\n<p>/**\n * The final Link Table will contain all of the individual keys one time as well as your concatenated keys\n */</p>\n\n<pre><code>[Link_table]:\n\n LOAD DISTINCT\n\n   \"Posting Date\",\n  DocNum,\n Cusnum,\n SKU,\n Quantity,\n Amount,\n\n\n\nDocNum &amp;'_'&amp;Cusnum  &amp;'_'&amp; SKU  &amp;'_'&amp; Bill2Num  &amp;'_'&amp;  Quantity  &amp;'_'&amp;Amount &amp;'_'&amp;[Posting Date]     AS Sales_Key, \nDocNum &amp;'_'&amp;Cusnum  &amp;'_'&amp; SKU&amp;'_'&amp;  Quantity  &amp;'_'&amp;Amount &amp;'_'&amp;[Posting Date]   AS Hist_Sales_Key,\nDocNum &amp;'_'&amp;Cusnum  &amp;'_'&amp; SKU  &amp;'_'&amp; Bill2Num  &amp;'_'&amp;  Quantity  &amp;'_'&amp;Amount  &amp;'_'&amp;\"Posting Date\"    AS CreditMemo_Key\n\n RESIDENT [Temp_Link_Table];\n\n\n DROP TABLE [Temp_Sales_Line];\n DROP TABLE [Temp_Hist_Sales];\n DROP TABLE [Temp_CM];\nDROP TABLE [Temp_Link_Table];\n</code></pre>"},"meta":{"#ns":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"@":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"#xml":{"version":"1.0","encoding":"utf-8"},"#type":"atom","#version":"1.0","title":"Newest questions tagged qlikview - Stack Overflow","description":"most recent 30 from stackoverflow.com","date":"2015-01-05T00:08:53.000Z","pubdate":"2015-01-05T00:08:53.000Z","pubDate":"2015-01-05T00:08:53.000Z","link":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","xmlurl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","xmlUrl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","author":null,"language":null,"favicon":null,"copyright":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf","generator":null,"cloud":{},"image":{},"categories":[],"atom:@":{"xmlns":"http://www.w3.org/2005/Atom","xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule","xmlns:re":"http://purl.org/atompub/rank/1.0"},"atom:title":{"@":{"type":"text"},"#":"Newest questions tagged qlikview - Stack Overflow"},"atom:link":[{"@":{"rel":"self","href":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","type":"application/atom+xml"}},{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","type":"text/html"}}],"atom:subtitle":{"@":{},"#":"most recent 30 from stackoverflow.com"},"atom:updated":{"@":{},"#":"2015-01-05T00:08:53Z"},"atom:id":{"@":{},"#":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest"},"creativecommons:license":{"@":{},"#":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf"}}}None\n    End With\n\n    With rng.Characters(65,5).Font\n        .Underline = xlUnderlineStyleSingle\n        .Color = RGB(59,181,245)\n    End With\n</code></pre>\n\n<p>Thank You</p>","summary":"<p>Good Day</p>\n\n<p>I require help with a macro that I've setup via QlikView's VBScript functionality. I got the original code from Stefan Walther's excellent blog, <a href=\"http://www.qlikblog.at/971/qliktip-32-exporting-multiple-objects-single-excel-document/comment-page-1/#comments\" rel=\"nofollow\">http://www.qlikblog.at/971/qliktip-32-exporting-multiple-objects-single-excel-document/comment-page-1/#comments</a>.</p>\n\n<p><strong>Problem Statement</strong>\nAfter extending the code to loop through Stefan's code depending on the type of report that needs to be generated and then loops through a list of names and generates the report based on the data tied to that person.The first person's report works perfectly, but I ran into problems with the second and subsequent reports having issues where string values being pasted to multiple rows (even though only one specific cell is specified) but only for certain strings.</p>\n\n<p><strong>What I've Tried</strong>\n1) I've tried removing my use of Range().Value to Range().Value2 and later Cell().Value.\n2) Stefan already has the following in to handle timing issues with screen refresh rates when pasting in objects and dealing with warning messages:</p>\n\n<blockquote>\n<pre><code>    Set objExcelApp = CreateObject(\"Excel.Application\")\n      objExcelApp.Visible = False           'suppresses the display of the Excel workbook\n      objExcelApp.DisplayAlerts = False 'suppresses warning popups\n</code></pre>\n</blockquote>\n\n<p>and I brought in </p>\n\n<blockquote>\n  <p>objExcelApp.ScreenUpdating = False</p>\n</blockquote>\n\n<p>just to see if it had an affect...but I would have</p>\n\n<p>thought Visible = False already handles this issue.</p>\n\n<p>3) I have also brought in </p>\n\n<blockquote>\n  <p>ActiveDocument.GetApplication.WaitForIdle\n  ActiveDocument.GetApplication.SLEEP 3000</p>\n</blockquote>\n\n<p>at different point in the script to try to avoid timing issues with the amount of content copied over thinking that the processor might be to quick (or slow) or something like that.</p>\n\n<p>4) And then lastly I've gone the route of adding \n          objExcelApp.CutCopyMode = False in the hopes that it is just a full clipboard issue causing delays in pasting. </p>\n\n<p><strong>Conclusion</strong>\nI'm not quite sure how to attach the script, but will gladly provide the code. </p>\n\n<p><strong>Amendment</strong>\nNot sure about attaching all of the script as a text file, but here is the code snippet that export the text elements and then formats the workbook:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub Excel_PopulateAdviserCommTextElements(objExcelDoc,sAdviserName,sAdviserIDNum,sAdviserEmail,sYear,sMonth,sMonthYear)\r\n\t\r\n\tsWorkbookName = sAdviserIDNum &amp;\"_\"&amp; sYear.GetContent.String &amp;\"_\"&amp;  sMonth.GetContent.String &amp;\"_\"&amp; sAdviserName\t\r\n\t\r\n\tSet summarySH = objExcelDoc.Sheets(\"Summary\")\r\n\t\r\n\t'transform the pasted objects to remove null rows and columns\r\n\tsummarySH.Columns(\"V:V\").Delete xlToLeft\r\n\tsummarySH.Rows(\"37:37\").Delete xlUp\r\n\tsummarySH.Rows(\"71:71\").Delete xlUp\r\n\t\r\n\t'replace \"-\" with zeroes for calculations\t\r\n    summarySH.Range(\"D9:V71\").Replace \"-\", \"0\", xlPart, xlByRows, False, False, False\t'What, Replacement, LookAt, SearchOrder, MatchCase, SearchFormat, ReplaceFormat\r\n        \r\n \t'calc table totals for asset table \r\n\tsummarySH.Range(\"V9:V37\").FormulaR1C1 = \"=SUM(RC[-18]:RC[-1])\"\r\n    summarySH.Range(\"D37:U37\").FormulaR1C1 = \"=SUM(R[-28]C:R[-1]C)\"\r\n    \r\n    'calc table totals for copmmission table \r\n\tsummarySH.Range(\"V43:V71\").FormulaR1C1 = \"=SUM(RC[-18]:RC[-1])\"\r\n \tsummarySH.Range(\"D71:U71\").FormulaR1C1 = \"=SUM(R[-28]C:R[-1]C)\"\r\n\r\n\t\r\n\t'add text elements\r\n\tsummarySH.Cells(2,3).Value = \"Wealth Solutions\"\r\n\tsummarySH.Cells(3,3).Value = \"Monthly Commission Report: End of \" &amp; sMonthYear.GetContent.String \r\n\tsummarySH.Cells(7,2).Value = \"ASSETS UNDER MANAGEMENT\"\r\n\tsummarySH.Cells(2,19).Value = \"Commission (Ex-VAT)\"\r\n\tsummarySH.Cells(3,19).Value = \"VAT @ 14%\"\r\n\tsummarySH.Cells(4,19).Value = \"Amount due\"\r\n\tsummarySH.Cells(2,22).Value = summarySH.Cells(71,22).Value\r\n\tsummarySH.Cells(3,22).Value = summarySH.Cells(71,22).Value*0.14\r\n\tsummarySH.Cells(4,22).Value = \"=Sum(V2:V3)\"\r\n\tsummarySH.Cells(41,2).Value = \"COMMISSION\"\r\n\t\r\n\t\r\n\t'format\r\n    summarySH.Range(\"V2:V4\").Style = \"Comma\"\r\n    summarySH.Range(\"D9:V37\").Style = \"Comma\"\r\n    summarySH.Range(\"D43:V71\").Style = \"Comma\"\r\n    \r\n\t'emails hyperlinks\r\n\tWith summarySH\t\t\t\t\t'advisor email\r\n\t  \t.Hyperlinks.Add .Cells(4,4), \"mailto:\"&amp;sAdviserEmail\r\n'\t  \t.Hyperlinks.Add .Range(\"D4\"), \"mailto:\"&amp;sAdviserEmail\r\n\t  \t.Hyperlinks(1).EmailSubject = \"Monthly Solutions Commission: \" &amp; sMonthYear.GetContent.String\r\n\t\t.Hyperlinks(1).TextToDisplay= sAdviserName\r\n\tEnd With\r\n\t\r\n\tsummarySH.Cells(75,2).Value = \"Queries\" \r\n\t\r\n\tset rng = summarySH.Cells(77,2)\t'commission payment email\r\n\t\r\n\t\tWith summarySH\r\n\t\t  \t.Hyperlinks.Add .Range(\"B77:H77\"), \"mailto:x@company.co.za\"\r\n\t\t  \t.Hyperlinks(2).EmailSubject = \"Monthly Solutions Commission Payment for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\r\n\t\t\t.Hyperlinks(2).TextToDisplay= \"For queries regarding the payment of this commission please email X or phone (000) 000 0000\"\r\n\t\tEnd With\r\n\t\t\r\n\t\tWith rng.Font\r\n\t        .ColorIndex = 0\r\n\t        .Underline = xlUnderlineStyleNone\r\n\t    End With\r\n\t\t\r\n\t    With rng.Characters(61,5).Font\r\n\t        .Underline = xlUnderlineStyleSingle\r\n\t        .Color = RGB(59,181,245)\r\n\t    End With\t\r\n\t\r\n\tset rng = summarySH.Range(\"B79\")\t'commission calc email\r\n\t\r\n\t\tWith summarySH\r\n\t\t  \t.Hyperlinks.Add .Range(\"B79:H79\"), \"mailto:y@company.co.za\"\r\n\t\t  \t.Hyperlinks(3).EmailSubject = \"Monthly Solutions Commission Calculation for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\r\n\t\t\t.Hyperlinks(3).TextToDisplay= \"For queries regarding the calculation of this commission please email Y or phone (000) 000 0000\"\r\n\t\tEnd With\r\n\t\t\r\n\t\tWith rng.Font\r\n\t        .ColorIndex = 0\r\n\t        .Underline = xlUnderlineStyleNone\r\n\t    End With\r\n\t\r\n\t    With rng.Characters(65,5).Font\r\n\t        .Underline = xlUnderlineStyleSingle\r\n\t        .Color = RGB(59,181,245)\r\n\t    End With\r\n    \r\n    \r\n\t'alter column width and row height\r\n\tsummarySH.Columns(\"A\").ColumnWidth   =  4.57\r\n\tsummarySH.Columns(\"B\").ColumnWidth   = 34.00\r\n\tsummarySH.Columns(\"C\").ColumnWidth   =  0.08\r\n\tsummarySH.Columns(\"D:U\").ColumnWidth = 13.28\r\n\tsummarySH.Columns(\"V\").ColumnWidth \t = 16.00\r\n\tsummarySH.Columns(\"W\").ColumnWidth   =  4.57\t\r\n\tsummarySH.Rows(\"1:1\").RowHeight \t = 33.00\r\n\tsummarySH.Rows(\"7:7\").RowHeight \t = 23.25\r\n\tsummarySH.Rows(\"39:39\").RowHeight \t = 23.25\t\r\n\tsummarySH.Rows(\"76:76\").RowHeight \t =  5.25\r\n\tsummarySH.Rows(\"78:78\").RowHeight \t =  5.25\r\n  \r\n\t\r\n\t'alignment\r\n\tsummarySH.Range(\"V2:V4\").HorizontalAlignment = xlRight\r\n\r\n\twith summarySH.Range(\"B7:U7\")\r\n\t\t.HorizontalAlignment = xlCenter\r\n\t\t.VerticalAlignment = xlCenter\r\n\t\t.Merge\r\n\tend with\r\n\t\r\n\twith summarySH.Range(\"B41:U41\")\r\n\t\t.HorizontalAlignment = xlCenter\r\n\t\t.VerticalAlignment = xlCenter\r\n\t\t.Merge\r\n\tend with\r\n\t\r\n\t'hide unused columns and rows and then fill with white\r\n    summarySH.Columns(\"X:XFD\").EntireColumn.Hidden = True\r\n\tsummarySH.Rows(\"83:1048576\").EntireRow.Hidden = True\r\n\t\r\n\tsummarySH.Range(\"A1:W82\").Interior.ColorIndex = 2\t'white\r\n\r\n\t'bold\r\n\tsummarySH.Range(\"C2:C3,R2:U4,B7,B41,B75\").Font.Bold = True\r\n\t\r\n\t'lines\r\n    With summarySH.Range(\"B7:V7\").Borders(xlEdgeBottom)\r\n        .LineStyle = xlContinuous\r\n        .ColorIndex = 1\r\n        .Weight = xlThin\r\n    End With\t\r\n\t\r\n\tWith summarySH.Range(\"B41:V41\").Borders(xlEdgeBottom)\r\n        .LineStyle = xlContinuous\r\n        .ColorIndex = 1\r\n        .Weight = xlThin\r\n    End With\t\r\n\t\r\n\t'adjust focus\r\n\t'summarySH.Range(\"A1\").Select\r\n\t\r\n\t'add filter to Consolidated sheet for Provider\r\n\tobjExcelDoc.Sheets(\"Consolidated\").Range(\"A1:T1\").AutoFilter\r\n\t\r\n\t'adjust focus\r\n\t'objExcelDoc.Sheets(\"Consolidated\").Range(\"A1\").Select\r\n\t\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The particular point where things go wonky withedata applied to rows 38:41 where apply a bold and a border:</p>\n\n<blockquote>\n  <p>summarySH.Cells(41,2).Value = \"COMMISSION\"</p>\n</blockquote>\n\n<p>and rows 72:82 with following section where I add hyperlinks with email adress details:</p>\n\n<blockquote>\n  <p>summarySH.Cells(75,2).Value = \"Queries\"</p>\n</blockquote>\n\n<pre><code>set rng = summarySH.Cells(77,2) 'commission payment email\n\n    With summarySH\n        .Hyperlinks.Add .Range(\"B77:H77\"), \"mailto:x@company.co.za\"\n        .Hyperlinks(2).EmailSubject = \"Monthly Solutions Commission Payment for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\n        .Hyperlinks(2).TextToDisplay= \"For queries regarding the payment of this commission please email X or phone (000) 000 0000\"\n    End With\n\n    With rng.Font\n        .ColorIndex = 0\n        .Underline = xlUnderlineStyleNone\n    End With\n\n    With rng.Characters(61,5).Font\n        .Underline = xlUnderlineStyleSingle\n        .Color = RGB(59,181,245)\n    End With    \n\nset rng = summarySH.Range(\"B79\")    'commission calc email\n\n    With summarySH\n        .Hyperlinks.Add .Range(\"B79:H79\"), \"mailto:y@company.co.za\"\n        .Hyperlinks(3).EmailSubject = \"Monthly Solutions Commission Calculation for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\n        .Hyperlinks(3).TextToDisplay= \"For queries regarding the calculation of this commission please email Y or phone (000) 000 0000\"\n    End With\n\n    With rng.Font\n        .ColorIndex = 0\n        .Underline = xlUnderlineStyleNone\n    End With\n\n    With rng.Characters(65,5).Font\n        .Underline = xlUnderlineStyleSingle\n        .Color = RGB(59,181,245)\n    End With\n</code></pre>\n\n<p>Thank You</p>","date":"2014-12-01T07:21:39.000Z","pubdate":"2014-11-18T08:02:54.000Z","pubDate":"2014-11-18T08:02:54.000Z","link":"http://stackoverflow.com/questions/26989326/vbscript-not-pasting-string-values-to-the-correct-row-in-excel","guid":"http://stackoverflow.com/q/26989326","author":"Charles Crous","comments":null,"origlink":null,"image":{},"source":{},"categories":["excel","vba","excel-vba","vbscript","qlikview"],"enclosures":[],"atom:@":{},"atom:id":{"@":{},"#":"http://stackoverflow.com/q/26989326"},"re:rank":{"@":{"scheme":"http://stackoverflow.com"},"#":"0"},"atom:title":{"@":{"type":"text"},"#":"VBScript not pasting string values to the correct row in Excel"},"atom:category":[{"@":{"scheme":"http://stackoverflow.com/tags","term":"excel"}},{"@":{"scheme":"http://stackoverflow.com/tags","term":"vba"}},{"@":{"scheme":"http://stackoverflow.com/tags","term":"excel-vba"}},{"@":{"scheme":"http://stackoverflow.com/tags","term":"vbscript"}},{"@":{"scheme":"http://stackoverflow.com/tags","term":"qlikview"}}],"atom:author":{"@":{},"name":{"@":{},"#":"Charles Crous"},"uri":{"@":{},"#":"http://stackoverflow.com/users/2987630"}},"atom:link":{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/26989326/vbscript-not-pasting-string-values-to-the-correct-row-in-excel"}},"atom:published":{"@":{},"#":"2014-11-18T08:02:54Z"},"atom:updated":{"@":{},"#":"2014-12-01T07:21:39Z"},"atom:summary":{"@":{"type":"html"},"#":"<p>Good Day</p>\n\n<p>I require help with a macro that I've setup via QlikView's VBScript functionality. I got the original code from Stefan Walther's excellent blog, <a href=\"http://www.qlikblog.at/971/qliktip-32-exporting-multiple-objects-single-excel-document/comment-page-1/#comments\" rel=\"nofollow\">http://www.qlikblog.at/971/qliktip-32-exporting-multiple-objects-single-excel-document/comment-page-1/#comments</a>.</p>\n\n<p><strong>Problem Statement</strong>\nAfter extending the code to loop through Stefan's code depending on the type of report that needs to be generated and then loops through a list of names and generates the report based on the data tied to that person.The first person's report works perfectly, but I ran into problems with the second and subsequent reports having issues where string values being pasted to multiple rows (even though only one specific cell is specified) but only for certain strings.</p>\n\n<p><strong>What I've Tried</strong>\n1) I've tried removing my use of Range().Value to Range().Value2 and later Cell().Value.\n2) Stefan already has the following in to handle timing issues with screen refresh rates when pasting in objects and dealing with warning messages:</p>\n\n<blockquote>\n<pre><code>    Set objExcelApp = CreateObject(\"Excel.Application\")\n      objExcelApp.Visible = False           'suppresses the display of the Excel workbook\n      objExcelApp.DisplayAlerts = False 'suppresses warning popups\n</code></pre>\n</blockquote>\n\n<p>and I brought in </p>\n\n<blockquote>\n  <p>objExcelApp.ScreenUpdating = False</p>\n</blockquote>\n\n<p>just to see if it had an affect...but I would have</p>\n\n<p>thought Visible = False already handles this issue.</p>\n\n<p>3) I have also brought in </p>\n\n<blockquote>\n  <p>ActiveDocument.GetApplication.WaitForIdle\n  ActiveDocument.GetApplication.SLEEP 3000</p>\n</blockquote>\n\n<p>at different point in the script to try to avoid timing issues with the amount of content copied over thinking that the processor might be to quick (or slow) or something like that.</p>\n\n<p>4) And then lastly I've gone the route of adding \n          objExcelApp.CutCopyMode = False in the hopes that it is just a full clipboard issue causing delays in pasting. </p>\n\n<p><strong>Conclusion</strong>\nI'm not quite sure how to attach the script, but will gladly provide the code. </p>\n\n<p><strong>Amendment</strong>\nNot sure about attaching all of the script as a text file, but here is the code snippet that export the text elements and then formats the workbook:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub Excel_PopulateAdviserCommTextElements(objExcelDoc,sAdviserName,sAdviserIDNum,sAdviserEmail,sYear,sMonth,sMonthYear)\r\n\t\r\n\tsWorkbookName = sAdviserIDNum &amp;\"_\"&amp; sYear.GetContent.String &amp;\"_\"&amp;  sMonth.GetContent.String &amp;\"_\"&amp; sAdviserName\t\r\n\t\r\n\tSet summarySH = objExcelDoc.Sheets(\"Summary\")\r\n\t\r\n\t'transform the pasted objects to remove null rows and columns\r\n\tsummarySH.Columns(\"V:V\").Delete xlToLeft\r\n\tsummarySH.Rows(\"37:37\").Delete xlUp\r\n\tsummarySH.Rows(\"71:71\").Delete xlUp\r\n\t\r\n\t'replace \"-\" with zeroes for calculations\t\r\n    summarySH.Range(\"D9:V71\").Replace \"-\", \"0\", xlPart, xlByRows, False, False, False\t'What, Replacement, LookAt, SearchOrder, MatchCase, SearchFormat, ReplaceFormat\r\n        \r\n \t'calc table totals for asset table \r\n\tsummarySH.Range(\"V9:V37\").FormulaR1C1 = \"=SUM(RC[-18]:RC[-1])\"\r\n    summarySH.Range(\"D37:U37\").FormulaR1C1 = \"=SUM(R[-28]C:R[-1]C)\"\r\n    \r\n    'calc table totals for copmmission table \r\n\tsummarySH.Range(\"V43:V71\").FormulaR1C1 = \"=SUM(RC[-18]:RC[-1])\"\r\n \tsummarySH.Range(\"D71:U71\").FormulaR1C1 = \"=SUM(R[-28]C:R[-1]C)\"\r\n\r\n\t\r\n\t'add text elements\r\n\tsummarySH.Cells(2,3).Value = \"Wealth Solutions\"\r\n\tsummarySH.Cells(3,3).Value = \"Monthly Commission Report: End of \" &amp; sMonthYear.GetContent.String \r\n\tsummarySH.Cells(7,2).Value = \"ASSETS UNDER MANAGEMENT\"\r\n\tsummarySH.Cells(2,19).Value = \"Commission (Ex-VAT)\"\r\n\tsummarySH.Cells(3,19).Value = \"VAT @ 14%\"\r\n\tsummarySH.Cells(4,19).Value = \"Amount due\"\r\n\tsummarySH.Cells(2,22).Value = summarySH.Cells(71,22).Value\r\n\tsummarySH.Cells(3,22).Value = summarySH.Cells(71,22).Value*0.14\r\n\tsummarySH.Cells(4,22).Value = \"=Sum(V2:V3)\"\r\n\tsummarySH.Cells(41,2).Value = \"COMMISSION\"\r\n\t\r\n\t\r\n\t'format\r\n    summarySH.Range(\"V2:V4\").Style = \"Comma\"\r\n    summarySH.Range(\"D9:V37\").Style = \"Comma\"\r\n    summarySH.Range(\"D43:V71\").Style = \"Comma\"\r\n    \r\n\t'emails hyperlinks\r\n\tWith summarySH\t\t\t\t\t'advisor email\r\n\t  \t.Hyperlinks.Add .Cells(4,4), \"mailto:\"&amp;sAdviserEmail\r\n'\t  \t.Hyperlinks.Add .Range(\"D4\"), \"mailto:\"&amp;sAdviserEmail\r\n\t  \t.Hyperlinks(1).EmailSubject = \"Monthly Solutions Commission: \" &amp; sMonthYear.GetContent.String\r\n\t\t.Hyperlinks(1).TextToDisplay= sAdviserName\r\n\tEnd With\r\n\t\r\n\tsummarySH.Cells(75,2).Value = \"Queries\" \r\n\t\r\n\tset rng = summarySH.Cells(77,2)\t'commission payment email\r\n\t\r\n\t\tWith summarySH\r\n\t\t  \t.Hyperlinks.Add .Range(\"B77:H77\"), \"mailto:x@company.co.za\"\r\n\t\t  \t.Hyperlinks(2).EmailSubject = \"Monthly Solutions Commission Payment for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\r\n\t\t\t.Hyperlinks(2).TextToDisplay= \"For queries regarding the payment of this commission please email X or phone (000) 000 0000\"\r\n\t\tEnd With\r\n\t\t\r\n\t\tWith rng.Font\r\n\t        .ColorIndex = 0\r\n\t        .Underline = xlUnderlineStyleNone\r\n\t    End With\r\n\t\t\r\n\t    With rng.Characters(61,5).Font\r\n\t        .Underline = xlUnderlineStyleSingle\r\n\t        .Color = RGB(59,181,245)\r\n\t    End With\t\r\n\t\r\n\tset rng = summarySH.Range(\"B79\")\t'commission calc email\r\n\t\r\n\t\tWith summarySH\r\n\t\t  \t.Hyperlinks.Add .Range(\"B79:H79\"), \"mailto:y@company.co.za\"\r\n\t\t  \t.Hyperlinks(3).EmailSubject = \"Monthly Solutions Commission Calculation for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\r\n\t\t\t.Hyperlinks(3).TextToDisplay= \"For queries regarding the calculation of this commission please email Y or phone (000) 000 0000\"\r\n\t\tEnd With\r\n\t\t\r\n\t\tWith rng.Font\r\n\t        .ColorIndex = 0\r\n\t        .Underline = xlUnderlineStyleNone\r\n\t    End With\r\n\t\r\n\t    With rng.Characters(65,5).Font\r\n\t        .Underline = xlUnderlineStyleSingle\r\n\t        .Color = RGB(59,181,245)\r\n\t    End With\r\n    \r\n    \r\n\t'alter column width and row height\r\n\tsummarySH.Columns(\"A\").ColumnWidth   =  4.57\r\n\tsummarySH.Columns(\"B\").ColumnWidth   = 34.00\r\n\tsummarySH.Columns(\"C\").ColumnWidth   =  0.08\r\n\tsummarySH.Columns(\"D:U\").ColumnWidth = 13.28\r\n\tsummarySH.Columns(\"V\").ColumnWidth \t = 16.00\r\n\tsummarySH.Columns(\"W\").ColumnWidth   =  4.57\t\r\n\tsummarySH.Rows(\"1:1\").RowHeight \t = 33.00\r\n\tsummarySH.Rows(\"7:7\").RowHeight \t = 23.25\r\n\tsummarySH.Rows(\"39:39\").RowHeight \t = 23.25\t\r\n\tsummarySH.Rows(\"76:76\").RowHeight \t =  5.25\r\n\tsummarySH.Rows(\"78:78\").RowHeight \t =  5.25\r\n  \r\n\t\r\n\t'alignment\r\n\tsummarySH.Range(\"V2:V4\").HorizontalAlignment = xlRight\r\n\r\n\twith summarySH.Range(\"B7:U7\")\r\n\t\t.HorizontalAlignment = xlCenter\r\n\t\t.VerticalAlignment = xlCenter\r\n\t\t.Merge\r\n\tend with\r\n\t\r\n\twith summarySH.Range(\"B41:U41\")\r\n\t\t.HorizontalAlignment = xlCenter\r\n\t\t.VerticalAlignment = xlCenter\r\n\t\t.Merge\r\n\tend with\r\n\t\r\n\t'hide unused columns and rows and then fill with white\r\n    summarySH.Columns(\"X:XFD\").EntireColumn.Hidden = True\r\n\tsummarySH.Rows(\"83:1048576\").EntireRow.Hidden = True\r\n\t\r\n\tsummarySH.Range(\"A1:W82\").Interior.ColorIndex = 2\t'white\r\n\r\n\t'bold\r\n\tsummarySH.Range(\"C2:C3,R2:U4,B7,B41,B75\").Font.Bold = True\r\n\t\r\n\t'lines\r\n    With summarySH.Range(\"B7:V7\").Borders(xlEdgeBottom)\r\n        .LineStyle = xlContinuous\r\n        .ColorIndex = 1\r\n        .Weight = xlThin\r\n    End With\t\r\n\t\r\n\tWith summarySH.Range(\"B41:V41\").Borders(xlEdgeBottom)\r\n        .LineStyle = xlContinuous\r\n        .ColorIndex = 1\r\n        .Weight = xlThin\r\n    End With\t\r\n\t\r\n\t'adjust focus\r\n\t'summarySH.Range(\"A1\").Select\r\n\t\r\n\t'add filter to Consolidated sheet for Provider\r\n\tobjExcelDoc.Sheets(\"Consolidated\").Range(\"A1:T1\").AutoFilter\r\n\t\r\n\t'adjust focus\r\n\t'objExcelDoc.Sheets(\"Consolidated\").Range(\"A1\").Select\r\n\t\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The particular point where things go wonky withedata applied to rows 38:41 where apply a bold and a border:</p>\n\n<blockquote>\n  <p>summarySH.Cells(41,2).Value = \"COMMISSION\"</p>\n</blockquote>\n\n<p>and rows 72:82 with following section where I add hyperlinks with email adress details:</p>\n\n<blockquote>\n  <p>summarySH.Cells(75,2).Value = \"Queries\"</p>\n</blockquote>\n\n<pre><code>set rng = summarySH.Cells(77,2) 'commission payment email\n\n    With summarySH\n        .Hyperlinks.Add .Range(\"B77:H77\"), \"mailto:x@company.co.za\"\n        .Hyperlinks(2).EmailSubject = \"Monthly Solutions Commission Payment for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\n        .Hyperlinks(2).TextToDisplay= \"For queries regarding the payment of this commission please email X or phone (000) 000 0000\"\n    End With\n\n    With rng.Font\n        .ColorIndex = 0\n        .Underline = xlUnderlineStyleNone\n    End With\n\n    With rng.Characters(61,5).Font\n        .Underline = xlUnderlineStyleSingle\n        .Color = RGB(59,181,245)\n    End With    \n\nset rng = summarySH.Range(\"B79\")    'commission calc email\n\n    With summarySH\n        .Hyperlinks.Add .Range(\"B79:H79\"), \"mailto:y@company.co.za\"\n        .Hyperlinks(3).EmailSubject = \"Monthly Solutions Commission Calculation for \"&amp; sAdviserName &amp;\" on \"&amp; sMonthYear.GetContent.String\n        .Hyperlinks(3).TextToDisplay= \"For queries regarding the calculation of this commission please email Y or phone (000) 000 0000\"\n    End With\n\n    With rng.Font\n        .ColorIndex = 0\n        .Underline = xlUnderlineStyleNone\n    End With\n\n    With rng.Characters(65,5).Font\n        .Underline = xlUnderlineStyleSingle\n        .Color = RGB(59,181,245)\n    End With\n</code></pre>\n\n<p>Thank You</p>"},"meta":{"#ns":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"@":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"#xml":{"version":"1.0","encoding":"utf-8"},"#type":"atom","#version":"1.0","title":"Newest questions tagged qlikview - Stack Overflow","description":"most recent 30 from stackoverflow.com","date":"2015-01-05T00:08:53.000Z","pubdate":"2015-01-05T00:08:53.000Z","pubDate":"2015-01-05T00:08:53.000Z","link":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","xmlurl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","xmlUrl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","author":null,"language":null,"favicon":null,"copyright":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf","generator":null,"cloud":{},"image":{},"categories":[],"atom:@":{"xmlns":"http://www.w3.org/2005/Atom","xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule","xmlns:re":"http://purl.org/atompub/rank/1.0"},"atom:title":{"@":{"type":"text"},"#":"Newest questions tagged qlikview - Stack Overflow"},"atom:link":[{"@":{"rel":"self","href":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","type":"application/atom+xml"}},{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","type":"text/html"}}],"atom:subtitle":{"@":{},"#":"most recent 30 from stackoverflow.com"},"atom:updated":{"@":{},"#":"2015-01-05T00:08:53Z"},"atom:id":{"@":{},"#":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest"},"creativecommons:license":{"@":{},"#":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf"}}}          }\n       .ext.pos .bar {\n        background-color: #004000;\n        border-bottom: 1px solid #004000;   \n        float: left;\n       }\n\n     .progresspos {  \n      vertical-align: middle;\n      float: left;\n       font-size:9px; \n       color: #004000;\n      }\n\n      .progressneg { \n        vertical-align: middle;\n        float: right;\n        font-size:9px; \n        color: #CE0000;\n         }\n\n      .border-neg{\n        background-color: #FFFFFF !Important;                              \n        border:1px solid #FE2E2E !Important;        }\n\n    .border-pos{\n           background-color: #FFFFFF !Important;                               \n           border:1px solid #004000 !Important;     \n            }\n    .dimbolded {\n      border-radius: 50%;\n      border:1px solid #000000;\n      padding:  1.5px;\n       }\n\n\n\n\n  .e6headerrow {\n       font-size:8pt; \n       font-family:Tahoma;\n       font-weight:bold; \n       padding: 5px;}\n\n  .e6firstcolumn {\n    text-align: left;\n    width: 14%;\n    max-width: 14%; \n    min-width: 14%;}\n\n\n  .e6thirdforthcolumn {\n\n   text-align: center;\n   width: 43% ;\n   max-width: 43%;  \n   min-width: 43%;}\n\n              .dimboldedgreen {\n                border-radius: 50%;\n                border:1px solid #004000;\n                padding:    1.5px;\n                }\n\n     .dimboldedred {\n       border-radius: 50%;\n       border:1px solid #FE2E2E;\n       padding:     1.5px;\n       }\n</code></pre>"},"meta":{"#ns":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"@":[{"xmlns":"http://www.w3.org/2005/Atom"},{"xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule"},{"xmlns:re":"http://purl.org/atompub/rank/1.0"}],"#xml":{"version":"1.0","encoding":"utf-8"},"#type":"atom","#version":"1.0","title":"Newest questions tagged qlikview - Stack Overflow","description":"most recent 30 from stackoverflow.com","date":"2015-01-05T00:08:53.000Z","pubdate":"2015-01-05T00:08:53.000Z","pubDate":"2015-01-05T00:08:53.000Z","link":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","xmlurl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","xmlUrl":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","author":null,"language":null,"favicon":null,"copyright":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf","generator":null,"cloud":{},"image":{},"categories":[],"atom:@":{"xmlns":"http://www.w3.org/2005/Atom","xmlns:creativecommons":"http://backend.userland.com/creativeCommonsRssModule","xmlns:re":"http://purl.org/atompub/rank/1.0"},"atom:title":{"@":{"type":"text"},"#":"Newest questions tagged qlikview - Stack Overflow"},"atom:link":[{"@":{"rel":"self","href":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest","type":"application/atom+xml"}},{"@":{"rel":"alternate","href":"http://stackoverflow.com/questions/tagged/?tagnames=qlikview&sort=newest","type":"text/html"}}],"atom:subtitle":{"@":{},"#":"most recent 30 from stackoverflow.com"},"atom:updated":{"@":{},"#":"2015-01-05T00:08:53Z"},"atom:id":{"@":{},"#":"http://stackoverflow.com/feeds/tag?tagnames=qlikview&sort=newest"},"creativecommons:license":{"@":{},"#":"http://www.creativecommons.org/licenses/by-sa/3.0/rdf"}}}